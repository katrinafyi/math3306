% vim: spelllang=en_au
\documentclass[a4paper]{article}

\usepackage{geometry}
\usepackage{amsmath}
% \usepackage{blkarray}
\usepackage{enumerate}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{hyperref}
\usepackage{minted}
% \usepackage[symbol]{footmisc}
\usepackage{tikz}
\usetikzlibrary{automata}
\usetikzlibrary{positioning,arrows.meta,calc}
\usetikzlibrary{angles,intersections,quotes,arrows.meta}

\DeclareMathOperator{\Diag}{Diag}
\DeclareMathOperator{\Th}{Th}

\DeclareMathOperator{\lcm}{lcm}

\author{Kait Lam \\ \small \texttt{45294583} \\ \small {T02}}
\title{\textsc{Math3306} --- Assignment 4 (Submission)}
\date{29 October 2024 (extension)}

\def\dotminus{\mathbin{\ooalign{\hss\raise1ex\hbox{.}\hss\cr
  \mathsurround=0pt$-$}}}

\begin{document}

\maketitle


\section*{Question 1}
% \subsection*{Question 1(a)}
\begin{center}
  \textit{This question asks which elements of $(\mathbb N, +)$ and $(\mathbb Z, +)$ are (0-)definable.}
\end{center}
In $(\mathbb N, +)$, we claim that every element is definable.
First, we define a comparison operator by
$x \le y \equiv (\exists z.~ x + z = y)$.
This can be thought of as a syntactic abbreviation if desired.
Now we make an inductive argument.
Starting with zero, we define 0 as the 
least value of the natural numbers,
$\varphi_0(z) \equiv (\forall y.~ z \le y)$.
This exists and is unique by properties of the natural numbers.
For the inductive case, assume 
there exists $\varphi_n$ defining $n$.
Then, we define $n+1$
as $\varphi_{n+1}(n') \equiv \neg \varphi_n(n')  \wedge (\forall y.\,(\exists x. \,\varphi_n(x)\wedge x \le y) \longrightarrow n' \le y)$.
That is, the least number which is greater than (but not equal to) $n$.
Here, 
$(\exists x. \,\varphi_n(x)\wedge x \le y)$
should be thought of as ``$n \le y$''.
This is a funny trick to give a name to the
value of $n$.

In $(\mathbb Z, +)$, only zero is definable.
Zero is the unique value satisfying 
$\varphi_0(z) \equiv (\forall y. \,y + z = y)$ (additive identity).
To see the remaining numbers are undefinable, we should look at the atomic
formulas expressable with this language;
with only a $+$ function, these formulas have the form
$x_1 + \cdots + x_n = y_1 + \cdots + y_m$.
However, whenever such a formula is satisfied by a valuation $\bar b$,
it is also satisfied by $-(\bar b)$---that is, $\bar b$
with its elements negated.
By induction on formula, this extends to all non-atomic formulas in the language.

This means that if a number satisfies a formula with one free variable,
so does its negation.
Therefore, all non-zero numbers cannot be defined by a formula.
Zero may still be definable (since it is equal to its negation),
and indeed we defined it earlier.



\section*{Question 2}
% \subsection*{Question 1(a)}
\begin{center}
  \textit{If $L$ is a language with only relations and $M$ and $N$ are
  elementarily-equivalent finite $L$-structures, then $M$ and $N$ are isomorphic.}
\end{center}
First, assume $L$ has only finitely many relations.
Let $A_M$ and $A_N$ be the object sets of $M$ and $N$, resp.
Consider the atomic diagram $\Diag(M)$.
As $A_M$ is finite and $L$ has finitely many relations,
the set $\Diag(M)$ is also finite.
Let $\varphi$ be the $L(A_M)$-sentence from conjoining all
sentences within $\Diag(M)$.
This is an elementary formula so it also holds in $N_{A_M}$
($N$ extended with constants from $A_M$), and so
$N_{A_M} \models \Diag(M)$.
By Robertson's lemma, this tells us there is an embedding of
$M$ into $N$.
By a symmetric argument, we can start with $\Diag(N)$ to obtain
an embedding of $N$ into $M$.
Since there is an embedding (injective and homomorphic) both ways, the two structures must be isomorphic.

For the general case where $L$ may be infinite, we seek some way to reduce
it to the finite case by exploiting the finiteness of $M$ and $N$.
With loss of generality, assume the relations in $L$ have bounded arity.
By the boundedness of arity and finiteness of the structures,
there are a finite number of distinct relations within the structure.
Therefore, we proceed as before but we take a finite subset of $\Diag(M)$
with only one representative relation from each equivalence class of equivalent
relations.
We then additionally introduce a (possibly-infinite) number of formulas
of the form $\forall x_1,\ldots,x_n.\, (R(x_1,\ldots,x_n) \longleftrightarrow R'(x_1,\ldots,x_n))$
for each pair of relations in each equivalence class.
These quantified formulas, as well as the formula from a subset of $\Diag(M)$,
are preserved in $N$ by elementary equivalence.
We can use this to show that the full theory of $\Diag(M)$ is modelled by $N$,
then proceed in the same way as the finite case.

When $L$ is infinite and its relations do not have a bounded arity,
we will have to do something else.
I can't think of how to do this.
Maybe the entire approach is wrong.

\section*{Question 3}
% \subsection*{Question 1(a)}
\begin{center}
  \textit{This question leads us on a journey with existential sentences.}
\end{center}
\subsection*{Question 3(a)}
\begin{center}
  \textit{For existential sentences $\psi$, if $N$ is a substructure of $M$ and $N \models \psi$, then $M \models \psi$.}
\end{center}
This is by induction on the number of existential quantifiers at the front
of the sentence $\psi$.
If there are no quantifiers, then we apply formula-induction on the quantifier-free $\psi$.
Since $N$ is a substructure of $M$, the inclusion map is an embedding,
so
for all terms $t$ and $\bar b$ from $A_N$, $t^N[\bar b] = t^M[\bar b]$.
This alone is sufficient for the $M \models (t_1 = t_2)[\bar b]$ case.
For the $M \models R(t_1, \ldots, t_n)[\bar b]$ case, we also need the property that
a homomorphism respects relations. 
Negation, conjunction, and disjunction hold straighforwardly by induction.

Now for the inductive case (of the main proof), consider a formula of the form $\exists x.\,\psi$. 
By $N \models \exists x.\, \psi[\bar b]$, there exists $a \in A_N$
such that $N \models \psi[\bar b \frac a x]$.
By substructure, we also have that $a \in A_M$ and so
$M \models \psi[\bar b \frac a x]$ and
$M \models \exists x.\,\psi[\bar b]$,
as required.
  

\subsection*{Question 3(b)}
\begin{center}
  \textit{Let $M$ and $N$ be models such that for all existential sentences, $N \models \psi$ implies $M \models \psi$.
  Then, there is a model $L$ such that $L$ is an extension of $N$, and $L$ is elementarily equivalent to $M$.}
\end{center}
We will try to show that $\Diag(N) \cup \Th(M)$ has a model.
In this way, $\Diag(N)$ encodes the object-related properties of $N$
(to  make $L$ extension an extension of $N$),
and $\Th(M)$ ensures $L$ is elementarily equivalent to $M$.

We will do this by compactness.
Take an arbitrary finite subset of $\Diag(N) \cup \Th(M)$.
By tutorial sheet 12's question 1, we can translate occurrences
of constants in this subset (arising from $\Diag(N)$)
with existentially-quantified variables,
e.g. $R(c_1,c_2)$ becomes $\exists x_1.\exists x_2.\, R(x_1, x_2)$,
and these theories are either both consistent or both inconsistent.
These replaced sentences are now existential,
and their construction from within $\Diag(N)$ means
means they were satisfied by $N$, and so they are also satisfied by $M$
due to existential preservation.

Therefore, they are in fact within $\Th(M)$ and so $M$
is a model of this translation of a finite subset of $\Diag(N) \cup \Th(M)$.
By the tutorial's question 1 and compactness,
this tells us there exists a model of $\Diag(N) \cup \Th(M)$.
Call this model $L$. 

Since $L \models \Diag(N)$, by Robinson's lemma,
we have that there is an embedding of $N$ into $L$.
This can be made into an extension by [identifying its objects with the objects of N???????].
Additionally,
since $L \models \Th(M)$, $L$ and $M$ must be elementarily equivalent.
This will be all.

% For each sentence in this subset originating from $\Diag(N)$,
% translate it to a form where its constants are replaced by existential quantification,
% This is now an existential formula, so it is satisfied by $M$ as well as $N$.



\subsection*{Question 3(c)}
\begin{center}
  \textit{Let $T$ be a first-order theory preserved under extensions. Define
    $T_\exists = \{\psi ~|~ \psi\text{ existential and } T \vdash \phi\}$.
    Assume $M \models T_\exists$ and define $\Sigma = \{ \neg \psi ~|~ \psi\text{ existential and }M \nvDash \psi\}$. Then, $T \cup \Sigma$ has a model.
  }
\end{center}
Omitted.
\subsection*{Question 3(d)}
\begin{center}
  \textit{Prove $T_\exists \vdash T$.}
\end{center}
Omitted.
\subsection*{Question 3(e)}
\begin{center}
  \textit{A sentence is preserved under extensions iff
  it is logically equivalent to an existential sentence.}
\end{center}
Omitted.



\end{document}

